!function(b,a){"object"==typeof exports&&"undefined"!=typeof module?module.exports=a():"function"==typeof define&&define.amd?define(a):b.KadenceAccordion=a()}(this,function(){"use strict";var e,f,g,h,i,d,a,b,c;function j(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}function k(){return(k=Object.assign||function(d){for(var a=1;a<arguments.length;a++){var b=arguments[a];for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(d[c]=b[c])}return d}).apply(this,arguments)}return function(){if("function"==typeof window.CustomEvent)return!1;function a(c,a){a=a||{bubbles:!1,cancelable:!1,detail:void 0};var b=document.createEvent("CustomEvent");return b.initCustomEvent(c,a.bubbles,a.cancelable,a.detail),b}a.prototype=window.Event.prototype,window.CustomEvent=a}(),Array.from||(Array.from=(e=Object.prototype.toString,f=function(a){return"function"==typeof a||"[object Function]"===e.call(a)},g=function(b){var a=Number(b);return isNaN(a)?0:0!==a&&isFinite(a)?(a>0?1:-1)*Math.floor(Math.abs(a)):a},h=9007199254740991,i=function(a){return Math.min(Math.max(g(a),0),h)},function(h){var g,c,j=Object(h);if(null==h)throw new TypeError("Array.from requires an array-like object - not null or undefined");var b=arguments.length>1?arguments[1]:void 0;if(void 0!==b){if(!f(b))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(g=arguments[2])}for(var d=i(j.length),e=f(this)?Object(new this(d)):new Array(d),a=0;a<d;)c=j[a],b?e[a]=void 0===g?b(c,a):b.call(g,c,a):e[a]=c,a+=1;return e.length=d,e})),window,a=((d=document).body||d.documentElement).style,b="",c="",""==a.WebkitAnimation&&(b="-webkit-"),""==a.MozAnimation&&(b="-moz-"),""==a.OAnimation&&(b="-o-"),""==a.WebkitTransition&&(c="-webkit-"),""==a.MozTransition&&(c="-moz-"),""==a.OTransition&&(c="-o-"),Object.defineProperty(Object.prototype,"onCSSAnimationEnd",{value:function(d){var c=function b(a){d(),a.target.removeEventListener(a.type,b)};return this.addEventListener("webkitAnimationEnd",c),this.addEventListener("mozAnimationEnd",c),this.addEventListener("oAnimationEnd",c),this.addEventListener("oanimationend",c),this.addEventListener("animationend",c),(""!=b||"animation"in a)&&"0s"!=getComputedStyle(this)[b+"animation-duration"]||d(),this},enumerable:!1,writable:!0}),Object.defineProperty(Object.prototype,"onCSSTransitionEnd",{value:function(d){var b=function b(a){d(),a.target.removeEventListener(a.type,b)};return this.addEventListener("webkitTransitionEnd",b),this.addEventListener("mozTransitionEnd",b),this.addEventListener("oTransitionEnd",b),this.addEventListener("transitionend",b),this.addEventListener("transitionend",b),(""!=c||"transition"in a)&&"0s"!=getComputedStyle(this)[c+"transition-duration"]||d(),this},enumerable:!1,writable:!0}),function(){var a,b,c;function d(a,e){var i=this;!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,d);var b="string"==typeof a?document.querySelector(a):a;if(null!=b){var f={headerClass:".kt-blocks-accordion-header",panelClass:".kt-accordion-panel",panelInnerClass:".kt-accordion-panel-inner",hiddenClass:"kt-accordion-panel-hidden",activeClass:"kt-accordion-panel-active",get hidenClass(){return this.hiddenClass},initializedClass:"kt-accordion-initialized",get initalisedClass(){return this.initializedClass},headerDataAttr:"data-kt-accordion-header-id",openMultiplePanels:!1,openHeadersOnLoad:[],headerOpenLabel:"",headerCloseLabel:"",roles:!0};this.settings=k({},f,e),this.container=b;var g=Array.from(this.container.children),c=[];Array.from(g).forEach(function(a){Array.from(a.children).forEach(function(a){c.push(a)})});var h=c.filter(function(a){return!a.classList.contains(i.settings.panelClass.substr(1))});this.headers=h.reduce(function(c,a){var d,e,b=Array.from(a.children).filter(function(a){return a.classList.contains(i.settings.headerClass.substr(1))});return!b.length&&a.children[0]&&a.children[0].children&&a.children[0].children.length&&(b=Array.from(a.children[0].children).filter(function(a){return a.classList.contains(i.settings.headerClass.substr(1))})),c=(d=[]).concat.apply(d,((function(a){if(Array.isArray(a)){for(var b=0,c=new Array(a.length);b<a.length;b++)c[b]=a[b];return c}})(e=c)||function(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()).concat([b]))},[]),this.panels=c.filter(function(a){return a.classList.contains(i.settings.panelClass.substr(1))}),this.toggleEl=void 0!==this.settings.toggleEl?Array.from(this.container.querySelectorAll(this.settings.toggleEl)):this.headers,this.states=[].map.call(this.headers,function(){return{state:"closed"}}),this.ids=[].map.call(this.headers,function(){return{id:Math.floor(1e6*Math.random()+1)}}),this.toggling=!1,this.container?this.init():console.log("Something is wrong with you markup...")}}return a=d,b=[{key:"init",value:function(){this._setupAttributes(),this._initalState(),this.calculateAllPanelsHeight(),this._insertDataAttrs(),this._addListeners(),this._finishInitialization()}},{key:"_setRole",value:function(a,b){("boolean"==typeof this.settings.roles&&this.settings.roles|| void 0!==this.settings.roles[a]&& !1!==this.settings.roles[a])&&b.setAttribute("role",a)}},{key:"_initalState",value:function(){var a=this.settings.openHeadersOnLoad;a.length&&(this.toggling=!0,this._openHeadersOnLoad(a)),this._renderDom()}},{key:"_insertDataAttrs",value:function(){var a=this;this.headers.forEach(function(b,c){b.setAttribute(a.settings.headerDataAttr,c)})}},{key:"_finishInitialization",value:function(){this.container.classList.add(this.settings.initializedClass),this._setRole("presentation",this.container);var a=new CustomEvent("initialized");this.container.dispatchEvent(a)}},{key:"_addListeners",value:function(){var a=this;this.headers.forEach(function(b,c){b.addEventListener("click",function(){a.handleClick(b,c)}),b.addEventListener("keydown",function(d){var b=d.which.toString(),f=d.ctrlKey&&b.match(/33|34/);if(b.match(/38|40/)||f){var g=b.match(/34|40/)?1:-1,e=a.headers.length,h=(c+e+g)%e;a.headers[h].focus(),d.preventDefault()}else if(b.match(/35|36/)){switch(b){case"36":a.headers[0].focus();break;case"35":a.headers[a.headers.length-1].focus()}d.preventDefault()}}),b.addEventListener("startOpen",function(){a.handleClick(b,c,!0)})})}},{key:"handleClick",value:function(b,c,a){a||(a=!1);var e=this,d=this.settings.headerClass.substr(1);if(b.classList.contains(d)&& !1===this.toggling)this.toggling=!0,this.setState(c),this._renderDom();else if(a)var f=setInterval(function(){!1===e.toggling&&(e.toggling=!0,e.setState(c),e._renderDom(),clearInterval(f))},50)}},{key:"setState",value:function(b){var c=this,a=this.getState();this.settings.openMultiplePanels||a.filter(function(a,c){c!=b&&(a.state="closed")}),a.filter(function(a,d){if(d==b){var e=c.toggleState(a.state);return a.state=e}})}},{key:"_renderDom",value:function(){var a=this;this.states.filter(function(b,c){"open"===b.state&&a.open(c,!1)}),this.states.filter(function(b,c){"closed"===b.state&&a.close(c,!1)})}},{key:"open",value:function(a){var b=!(arguments.length>1)|| void 0===arguments[1]||arguments[1];b&&this.setState(a),this.togglePanel("open",a)}},{key:"close",value:function(a){var b=!(arguments.length>1)|| void 0===arguments[1]||arguments[1];b&&this.setState(a),this.togglePanel("closed",a)}},{key:"openAll",value:function(){var a=this;this.headers.forEach(function(c,b){a.togglePanel("open",b)})}},{key:"closeAll",value:function(){var a=this;this.headers.forEach(function(c,b){a.togglePanel("closed",b)})}},{key:"togglePanel",value:function(d,c){var h=this;if(void 0!==d&& void 0!==c){if("closed"===d){var e=this.headers[c],b=this.panels[c];!b.classList.contains(this.settings.hiddenClass)&&(b.setAttribute("data-panel-height",b.scrollHeight+"px"),b.style.height=b.scrollHeight+"px",b.offsetHeight,b.style.height="",b.classList.add("kt-panel-is-collapsing"),b.classList.remove(this.settings.activeClass),e.classList.remove(this.settings.activeClass),e.setAttribute("aria-expanded",!1),setTimeout(function(){return b.classList.add(h.settings.hiddenClass),b.classList.remove("kt-panel-is-collapsing"),h.toggling=!1},1e3*parseFloat(getComputedStyle(b).transitionDuration)))}else if("open"===d){var f=this.headers[c],a=this.panels[c];if(!a.classList.contains(this.settings.activeClass)){a.classList.remove(this.settings.hiddenClass),a.style.height=0,a.offsetHeight,a.classList.add("kt-panel-is-expanding"),a.style.height=a.scrollHeight<parseInt(a.getAttribute("data-panel-height"))?parseInt(a.getAttribute("data-panel-height"))+"px":a.scrollHeight+"px",a.offsetHeight,f.classList.add(this.settings.activeClass),f.setAttribute("aria-expanded",!0);var g=window.document.createEvent("UIEvents");g.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(g),setTimeout(function(){return a.classList.add(h.settings.activeClass),a.style.height="",a.classList.remove("kt-panel-is-expanding"),h.toggling=!1},1e3*parseFloat(getComputedStyle(a).transitionDuration))}}}}},{key:"getState",value:function(){var b=this,a=arguments.length>0&& void 0!==arguments[0]?arguments[0]:[];return a.length&&Array.isArray(a)?a.map(function(a){return b.states[a]}):this.states}},{key:"toggleState",value:function(a){if(void 0!==a)return"closed"===a?"open":"closed"}},{key:"_openHeadersOnLoad",value:function(){var b=this,a=arguments.length>0&& void 0!==arguments[0]?arguments[0]:[];a.length&&Array.isArray(a)&&a.filter(function(a){return void 0!=a}).forEach(function(a){b.setState(a)})}},{key:"_setupAttributes",value:function(){this._setupHeaders(),this._setupPanels(),this._insertDataAttrs()}},{key:"_setPanelHeight",value:function(){this.calculateAllPanelsHeight()}},{key:"calculatePanelHeight",value:function(a){var b=a.querySelector(this.settings.panelInnerClass).getBoundingClientRect();return a.setAttribute("data-panel-height","".concat(b.height,"px"))}},{key:"calculateAllPanelsHeight",value:function(){var a=this;this.panels.forEach(function(b){a.calculatePanelHeight(b)})}},{key:"_setupHeaders",value:function(){var a=this;this.headers.forEach(function(b,c){b.setAttribute("id","kt-accordion-header-".concat(a.ids[c].id)),b.setAttribute("aria-controls","kt-accordion-panel-".concat(a.ids[c].id))})}},{key:"_setupPanels",value:function(){var a=this;this.panels.forEach(function(b,c){b.setAttribute("id","kt-accordion-panel-".concat(a.ids[c].id)),b.setAttribute("aria-labelledby","kt-accordion-header-".concat(a.ids[c].id)),(!0===a.settings.roles|| !1!==a.settings.roles.region)&&a._setRole("region",b)})}}],j(a.prototype,b),c&&j(a,c),d}()}),function(){"use strict";var a=!1;window.KadenceBlocksAccordion={scroll:function(b,c,a){if(!(a<=0)){var d=(c-b.scrollTop)/a*10;setTimeout(function(){b.scrollTop=b.scrollTop+d,b.scrollTop!==c&&scrollTo(b,c,a-10)},10)}},anchor:function(b){if(""!=window.location.hash){var d,c=location.hash.substring(1);if(/^[A-z0-9_-]+$/.test(c)&&(!b.type||"initialized"!==b.type||!a)&&(a=!0,(d=document.getElementById(c))&&d.classList.contains("wp-block-kadence-pane"))){var e=document.querySelectorAll("#"+c+" .kt-blocks-accordion-header")[0];e.classList.contains("kt-accordion-panel-active")||(b.type&&"initialized"===b.type?window.setTimeout(function(){e.dispatchEvent(new Event("startOpen"))},50):e.dispatchEvent(new Event("startOpen")))}}},init:function(){for(var f=document.querySelectorAll(".kt-accordion-inner-wrap"),b=Array.from(f),a=0,g=b.length;a<g;a++){var h=b[a].getAttribute("data-allow-multiple-open"),d=b[a].getAttribute("data-start-open"),e=parseInt(d);if("none"!==d){for(var c=0,i=b[a].children.length;c<i;c++)if(b[a].children[c].classList.contains("kt-accordion-pane-"+parseInt(1+e))){e=c;break}}b[a].addEventListener("initialized",window.KadenceBlocksAccordion.anchor,!1),new KadenceAccordion(b[a],{openHeadersOnLoad:"none"===d?[]:[parseInt(e)],headerClass:".kt-blocks-accordion-header",panelClass:".kt-accordion-panel",panelInnerClass:".kt-accordion-panel-inner",hiddenClass:"kt-accordion-panel-hidden",activeClass:"kt-accordion-panel-active",initializedClass:"kt-accordion-initialized",headerDataAttr:"data-kt-accordion-header-id",openMultiplePanels:"true"===h,roles:{presentation:!1}})}window.addEventListener("hashchange",window.KadenceBlocksAccordion.anchor,!1)}},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",window.KadenceBlocksAccordion.init):window.KadenceBlocksAccordion.init()}()
