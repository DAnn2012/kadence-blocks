!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b((a="undefined"==typeof globalThis?a||self:globalThis).FloatingUICore={})}(this,function(j){"use strict";function q(a,b,c){return o(a,J(b,c))}function G(a,b){return"function"==typeof a?a(b):a}function z(a){return a.split("-")[0]}function C(a){return a.split("-")[1]}function c(a){return"x"===a?"y":"x"}function u(a){return"y"===a?"height":"width"}function B(a){return["top","bottom"].includes(z(a))?"y":"x"}function d(a){return c(B(a))}function f(b,c,e){void 0===e&&(e=!1);const f=C(b),g=d(b),i=u(g);let j="x"===g?f===(e?"end":"start")?"right":"left":"start"===f?"bottom":"top";return c.reference[i]>c.floating[i]&&(j=h(j)),[j,h(j)]}function g(b){return b.replace(/start|end/g,b=>a[b])}function h(a){return a.replace(/left|right|bottom|top/g,a=>e[a])}function I(a){return"number"==typeof a?{top:a,right:a,bottom:a,left:a}:function(a){return{top:0,right:0,bottom:0,left:0,...a}}(a)}function k(a){const{x:b,y:c,width:d,height:e}=a;return{width:d,height:e,top:c,left:b,right:b+d,bottom:c+e,x:b,y:c}}function v(b,c,e){let{reference:g,floating:i}=b;const j=B(c),k=d(c),a=u(k),l=z(c),n="y"===j,f=g.x+g.width/2-i.width/2,m=g.y+g.height/2-i.height/2,h=g[a]/2-i[a]/2;let o;switch(o="top"===l?{x:f,y:g.y-i.height}:"bottom"===l?{x:f,y:g.y+g.height}:"right"===l?{x:g.x+g.width,y:m}:"left"===l?{x:g.x-i.width,y:m}:{x:g.x,y:g.y},C(c)){case"start":o[k]-=h*(e&&n?-1:1);break;case"end":o[k]+=h*(e&&n?-1:1)}return o}async function F(f,j){var q;void 0===j&&(j={});const{x:t,y:i,platform:o,rects:r,elements:a,strategy:l}=f,{boundary:s="clippingAncestors",rootBoundary:c="viewport",elementContext:u="floating",altBoundary:m=!1,padding:d=0}=G(j,f),g=I(d),p=a[m?"floating"===u?"reference":"floating":u],h=k(await o.getClippingRect({element:null==(q=await(null==o.isElement?void 0:o.isElement(p)))||q?p:p.contextElement||(await(null==o.getDocumentElement?void 0:o.getDocumentElement(a.floating))),boundary:s,rootBoundary:c,strategy:l})),v="floating"===u?{x:t,y:i,width:r.floating.width,height:r.floating.height}:r.reference,w=await(null==o.getOffsetParent?void 0:o.getOffsetParent(a.floating)),b=(await(null==o.isElement?void 0:o.isElement(w)))&&(await(null==o.getScale?void 0:o.getScale(w)))||{x:1,y:1},x=k(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:v,offsetParent:w,strategy:l}):v);return{top:(h.top-x.top+g.top)/b.y,bottom:(x.bottom-h.bottom+g.bottom)/b.y,left:(h.left-x.left+g.left)/b.x,right:(x.right-h.right+g.right)/b.x}}function b(a,b){return{top:a.top-b.height,right:a.right-b.width,bottom:a.bottom-b.height,left:a.left-b.width}}function m(a){return p.some(b=>0<=a[b])}function x(a){const b=J(...a.map(a=>a.left)),c=J(...a.map(a=>a.top));return{x:b,y:c,width:o(...a.map(a=>a.right))-b,height:o(...a.map(a=>a.bottom))-c}}const p=["top","right","bottom","left"],s=["start","end"],y=p.reduce((a,b)=>a.concat(b,b+"-"+s[0],b+"-"+s[1]),[]),J=Math.min,o=Math.max,e={left:"right",right:"left",bottom:"top",top:"bottom"},a={start:"end",end:"start"};j.arrow=f=>({name:"arrow",options:f,async fn(o){const{x:e,y:n,placement:i,rects:p,platform:a,elements:l,middlewareData:c}=o,{element:m,padding:g=0}=G(f,o)||{};if(null==m)return{};const h=I(g),r={x:e,y:n},s=d(i),t=u(s),b=await a.getDimensions(m),v="y"===s,w=v?"top":"left",x=v?"bottom":"right",y=v?"clientHeight":"clientWidth",A=p.reference[t]+p.reference[s]-r[s]-p.floating[t],D=r[s]-p.reference[s],E=await(null==a.getOffsetParent?void 0:a.getOffsetParent(m));let K=E?E[y]:0;K&&(await(null==a.isElement?void 0:a.isElement(E)))||(K=l.floating[y]||p.floating[t]);const L=K/2-b[t]/2-1,B=J(h[w],L),H=J(h[x],L),N=B,F=K-b[t]-H,j=K/2-b[t]/2+(A/2-D/2),z=q(N,j,F),M=!c.arrow&&null!=C(i)&&j!==z&&0>p.reference[t]/2-(j<N?B:H)-b[t]/2,O=M?j<N?j-N:j-F:0;return{[s]:r[s]+O,data:{[s]:z,centerOffset:j-z-O,...(M&&{alignmentOffset:O})},reset:M}}}),j.autoPlacement=function(c){return void 0===c&&(c={}),{name:"autoPlacement",options:c,async fn(h){var e,i,j;const{rects:q,middlewareData:a,placement:l,platform:s,elements:m}=h,{crossAxis:u=!1,alignment:d,allowedPlacements:t=y,autoAlignment:v=!0,...p}=G(c,h),w=void 0!==d||t===y?function(a,b,c){return(a?[...c.filter(b=>C(b)===a),...c.filter(b=>C(b)!==a)]:c.filter(a=>z(a)===a)).filter(c=>!a||C(c)===a||!!b&&g(c)!==c)}(d||null,v,t):t,b=await F(h,p),x=(null==(e=a.autoPlacement)?void 0:e.index)||0,A=w[x];if(null==A)return{};const B=f(A,q,await(null==s.isRTL?void 0:s.isRTL(m.floating)));if(l!==A)return{reset:{placement:w[0]}};const D=[b[z(A)],b[B[0]],b[B[1]]],H=[...((null==(i=a.autoPlacement)?void 0:i.overflows)||[]),{placement:A,overflows:D}],E=w[x+1];if(E)return{data:{index:x+1,overflows:H},reset:{placement:E}};const I=H.map(a=>{const b=C(a.placement);return[a.placement,b&&u?a.overflows.slice(0,2).reduce((a,b)=>a+b,0):a.overflows[0],a.overflows]}).sort((a,b)=>a[1]-b[1]),k=(null==(j=I.filter(a=>a[2].slice(0,C(a[0])?2:3).every(a=>0>=a))[0])?void 0:j[0])||I[0][0];return k===l?{}:{data:{index:x+1,overflows:H},reset:{placement:k}}}}},j.computePosition=async(b,j,e)=>{const{placement:a="bottom",strategy:i="absolute",middleware:h=[],platform:k}=e,o=h.filter(Boolean),l=await(null==k.isRTL?void 0:k.isRTL(j));let q=await k.getElementRects({reference:b,floating:j,strategy:i}),{x:s,y:t}=v(q,a,l),z=a,A={},B=0;for(let c=0;c<o.length;c++){const{name:d,fn:e}=o[c],{x:f,y:g,data:h,reset:m}=await e({x:s,y:t,initialPlacement:a,placement:z,strategy:i,middlewareData:A,rects:q,platform:k,elements:{reference:b,floating:j}});s=null==f?s:f,t=null==g?t:g,A={...A,[d]:{...A[d],...h}},m&&50>=B&&(B++,"object"==typeof m&&(m.placement&&(z=m.placement),m.rects&&(q=!0===m.rects?await k.getElementRects({reference:b,floating:j,strategy:i}):m.rects),({x:s,y:t}=v(q,z,l))),c=-1)}return{x:s,y:t,placement:z,strategy:i,middlewareData:A}},j.detectOverflow=F,j.flip=function(c){return void 0===c&&(c={}),{name:"flip",options:c,async fn(j){var e,q;const{placement:u,middlewareData:o,rects:r,initialPlacement:a,platform:l,elements:s}=j,{mainAxis:t=!0,crossAxis:d=!0,fallbackPlacements:m,fallbackStrategy:w="bestFit",fallbackAxisSideDirection:x="none",flipAlignment:v=!0,...p}=G(c,j);if(null!=(e=o.arrow)&&e.alignmentOffset)return{};const b=z(u),y=z(a)===a,A=await(null==l.isRTL?void 0:l.isRTL(s.floating)),D=m||(y||!v?[h(a)]:function(a){const b=h(a);return[g(a),b,g(b)]}(a));m||"none"===x||D.push(...function(a,b,c,d){const e=C(a);let f=function(a,b,c){const d=["left","right"],e=["right","left"];return"top"===a||"bottom"===a?c?b?e:d:b?d:e:"left"===a||"right"===a?b?["top","bottom"]:["bottom","top"]:[]}(z(a),"start"===c,d);return e&&(f=f.map(a=>a+"-"+e),b&&(f=f.concat(f.map(g)))),f}(a,v,x,A));const I=[a,...D],E=await F(j,p),J=[];let k=(null==(q=o.flip)?void 0:q.overflows)||[];if(t&&J.push(E[b]),d){const a=f(u,r,A);J.push(E[a[0]],E[a[1]])}if(k=[...k,{placement:u,overflows:J}],!J.every(a=>0>=a)){var K,L;const b=((null==(K=o.flip)?void 0:K.index)||0)+1,c=I[b];if(c)return{data:{index:b,overflows:k},reset:{placement:c}};let d=null==(L=k.filter(a=>0>=a.overflows[0]).sort((a,b)=>a.overflows[1]-b.overflows[1])[0])?void 0:L.placement;if(!d)switch(w){case"bestFit":{var M;const a=null==(M=k.map(a=>[a.placement,a.overflows.filter(a=>0<a).reduce((a,b)=>a+b,0)]).sort((a,b)=>a[1]-b[1])[0])?void 0:M[0];a&&(d=a);break}case"initialPlacement":d=a}if(u!==d)return{reset:{placement:d}}}return{}}}},j.hide=function(a){return void 0===a&&(a={}),{name:"hide",options:a,async fn(c){const{rects:d}=c,{strategy:f="referenceHidden",...e}=G(a,c);switch(f){case"referenceHidden":{const a=b(await F(c,{...e,elementContext:"reference"}),d.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:m(a)}}}case"escaped":{const a=b(await F(c,{...e,altBoundary:!0}),d.floating);return{data:{escapedOffsets:a,escaped:m(a)}}}default:return{}}}}},j.inline=function(c){return void 0===c&&(c={}),{name:"inline",options:c,async fn(f){const{placement:g,elements:e,rects:i,platform:a,strategy:j}=f,{padding:d=2,x:l,y:m}=G(c,f),n=Array.from((await(null==a.getClientRects?void 0:a.getClientRects(e.reference)))||[]),p=function(a){const b=a.slice().sort((a,b)=>a.y-b.y),c=[];let d=null;for(let e=0;e<b.length;e++){const a=b[e];!d||a.y-d.y>d.height/2?c.push([a]):c[c.length-1].push(a),d=a}return c.map(a=>k(x(a)))}(n),h=k(x(n)),q=I(d),r=await a.getElementRects({reference:{getBoundingClientRect:function(){if(2===p.length&&p[0].left>p[1].right&&null!=l&&null!=m)return p.find(a=>l>a.left-q.left&&l<a.right+q.right&&m>a.top-q.top&&m<a.bottom+q.bottom)||h;if(2<=p.length){if("y"===B(g)){const b=p[0],c=p[p.length-1],d="top"===z(g),e=b.top,f=c.bottom,h=d?b.left:c.left,a=d?b.right:c.right;return{top:e,bottom:f,left:h,right:a,width:a-h,height:f-e,x:h,y:e}}const b="left"===z(g),c=o(...p.map(a=>a.right)),d=J(...p.map(a=>a.left)),e=p.filter(a=>b?a.left===d:a.right===c),a=e[0].top,f=e[e.length-1].bottom;return{top:a,bottom:f,left:d,right:c,width:c-d,height:f-a,x:d,y:a}}return h}},floating:e.floating,strategy:j});return i.reference.x!==r.reference.x||i.reference.y!==r.reference.y||i.reference.width!==r.reference.width||i.reference.height!==r.reference.height?{reset:{rects:r}}:{}}}},j.limitShift=function(f){return void 0===f&&(f={}),{options:f,fn(g){const{x:e,y:j,placement:k,rects:m,middlewareData:o}=g,{offset:a=0,mainAxis:i=!0,crossAxis:l=!0}=G(f,g),n={x:e,y:j},d=B(k),p=c(d);let h=n[p],q=n[d];const r=G(a,g),s="number"==typeof r?{mainAxis:r,crossAxis:0}:{mainAxis:0,crossAxis:0,...r};if(i){const a="y"===p?"height":"width",b=m.reference[p]-m.floating[a]+s.mainAxis,c=m.reference[p]+m.reference[a]-s.mainAxis;h<b?h=b:h>c&&(h=c)}if(l){var u,v;const a="y"===p?"width":"height",b=["top","left"].includes(z(k)),c=m.reference[d]-m.floating[a]+(b&&(null==(u=o.offset)?void 0:u[d])||0)+(b?0:s.crossAxis),e=m.reference[d]+m.reference[a]+(b?0:(null==(v=o.offset)?void 0:v[d])||0)-(b?s.crossAxis:0);q<c?q=c:q>e&&(q=e)}return{[p]:h,[d]:q}}}},j.offset=function(b){return void 0===b&&(b=0),{name:"offset",options:b,async fn(c){var d,e;const{x:f,y:g,placement:h,middlewareData:a}=c,j=await async function(b,c){const{placement:e,platform:f,elements:g}=b,i=await(null==f.isRTL?void 0:f.isRTL(g.floating)),j=z(e),a=C(e),k="y"===B(e),l=["left","top"].includes(j)?-1:1,m=i&&k?-1:1,d=G(c,b);let{mainAxis:n,crossAxis:h,alignmentAxis:o}="number"==typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return a&&"number"==typeof o&&(h="end"===a?-1*o:o),k?{x:h*m,y:n*l}:{x:n*l,y:h*m}}(c,b);return h===(null==(d=a.offset)?void 0:d.placement)&&null!=(e=a.arrow)&&e.alignmentOffset?{}:{x:f+j.x,y:g+j.y,data:{...j,placement:h}}}}},j.rectToClientRect=k,j.shift=function(b){return void 0===b&&(b={}),{name:"shift",options:b,async fn(f){const{x:e,y:g,placement:i}=f,{mainAxis:k=!0,crossAxis:m=!1,limiter:a={fn:a=>{let{x:b,y:c}=a;return{x:b,y:c}}},...j}=G(b,f),l={x:e,y:g},d=await F(f,j),n=B(z(i)),h=c(n);let o=l[h],p=l[n];if(k){const a="y"===h?"bottom":"right";o=q(o+d["y"===h?"top":"left"],o,o-d[a])}if(m){const a="y"===n?"bottom":"right";p=q(p+d["y"===n?"top":"left"],p,p-d[a])}const r=a.fn({...f,[h]:o,[n]:p});return{...r,data:{x:r.x-e,y:r.y-g}}}}},j.size=function(c){return void 0===c&&(c={}),{name:"size",options:c,async fn(f){const{placement:e,rects:g,platform:i,elements:a}=f,{apply:l=()=>{},...j}=G(c,f),m=await F(f,j),d=z(e),n=C(e),h="y"===B(e),{width:p,height:q}=g.floating;let r,s;"top"===d||"bottom"===d?(r=d,s=n===((await(null==i.isRTL?void 0:i.isRTL(a.floating)))?"start":"end")?"left":"right"):(s=d,r="end"===n?"top":"bottom");const t=q-m.top-m.bottom,u=p-m.left-m.right,w=J(q-m[r],t),x=J(p-m[s],u),y=!f.middlewareData.shift;let A=w,D=x;if(h?D=n||y?J(x,u):u:A=n||y?J(w,t):t,y&&!n){const a=o(m.left,0),b=o(m.right,0),c=o(m.top,0),d=o(m.bottom,0);h?D=p-2*(0!==a||0!==b?a+b:o(m.left,m.right)):A=q-2*(0!==c||0!==d?c+d:o(m.top,m.bottom))}await l({...f,availableWidth:D,availableHeight:A});const H=await i.getDimensions(a.floating);return p!==H.width||q!==H.height?{reset:{rects:!0}}:{}}}}});